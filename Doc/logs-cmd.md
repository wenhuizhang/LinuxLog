# Logs and Commands 

Logs and commands to collect them.

## 1. Logs 

|        |               |                                   |                           |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
|--------|---------------|-----------------------------------|---------------------------|----------------------------------------|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--| 
| Number | Software Name | Description                       | Location                  | Comments                               |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 1      | linux         | plentext password                 | /etc/passwd               |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 2      | linux         | encrypted password                | /etc/shadow               |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 3      | linux         | user access control               | /etc/security/*           | containers and groups' access control  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 4      | linux         | system log                        | /etc/rsyslog.d/*          |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 5      | linux         | kmesg                             | /proc/kmsg                |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 6      | docker        | docker filesystem and aufs layers | /var/lib/docker           |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 7      | linux         | audit logs                        | /var/log/audit/audit.log  |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 8      | linux         | authenticatoin logs               | /var/log/auth.log         |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 9      | linux         | daemon logs, docker etc.          | /var/log/daemon.log       | journalctl -u docker.service           |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 10     | linux         | DNF log                           | /var/log/dnf.log          | software package manager log           |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 11     | linux         | system log                        | /var/log/syslog           |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 12     | linux         | secure module logs                | /var/log/secure           |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 13     | linux         | kernel log                        | /var/log/kern.log         |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 14     | linux         | logs for logins and logouts       | /var/log/wtmp             |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 15     | linux         | kernel version                    | /proc/version             |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 16     | linux         | kernel boot entry point  info     | /proc/cmdline             |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
| 17     | openstack     | openstack log                     | /var/log/nova/*           |                                        |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 


## 2. Commands

|                                                                                                           |                                                                                                     |                                                                       |                                               | 
|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|-----------------------------------------------| 
| collect life system state                                                                                 | capture network activity : tcp, udp, stream data                                                    | netstat -naovp                                                        |                                               | 
|                                                                                                           | capture network activity : tcp and udp                                                              | netstat -inet -naov                                                   |                                               | 
|                                                                                                           | capture network activity : dump socket statistics                                                   | ss                                                                    |                                               | 
|                                                                                                           | essential system data commands : configure a network interface                                      | ifconfig                                                              |                                               | 
|                                                                                                           | essential system data commands : all or part of environment                                         | printenv                                                              |                                               | 
|                                                                                                           | essential system data commands : system's host name                                                 | hostname                                                              |                                               | 
|                                                                                                           | essential system data commands : effective userid                                                   | whoami                                                                |                                               | 
|                                                                                                           | essential system data commands : real and effective user and group IDs                              | id                                                                    |                                               | 
|                                                                                                           | essential system data commands : current user's name                                                | logname                                                               |                                               | 
|                                                                                                           | essential system data commands : how long the system has been running                               | uptime                                                                |                                               | 
|                                                                                                           | essential system data commands : kernel version                                                     | uname -a                                                              |                                               | 
|                                                                                                           | essential system data commands : more detailed kernel version                                       | cat /proc/version                                                     |                                               | 
|                                                                                                           | essential system data commands : cpu                                                                | cat /proc/cpuinfo                                                     |                                               | 
|                                                                                                           | essential system data commands : kernel boot                                                        | cat /proc/cmdline                                                     |                                               | 
|                                                                                                           | essential system data commands : routing table                                                      | netstat -nr                                                           |                                               | 
|                                                                                                           | essential system data commands : arp cache                                                          | arp -a                                                                |                                               | 
|                                                                                                           | capture currently logged on user data : who is logged on                                            | who                                                                   |                                               | 
|                                                                                                           | capture currently logged on user data : who is logged on and what they are doing                    | w                                                                     |                                               | 
|                                                                                                           | capture currently logged on user data : user names of users currently logged in to the current host | users                                                                 |                                               | 
|                                                                                                           | process data : list open files                                                                      | lsof -l                                                               |                                               | 
|                                                                                                           | process data : snapshot of the all processes                                                        | ps -e                                                                 |                                               | 
|                                                                                                           | process data : snapshot of the all processes with full format listing                               | ps -ef                                                                |                                               | 
|                                                                                                           | process data : snapshot of the all processes with full format listing                               | ps aux                                                                |                                               | 
|                                                                                                           | process data : display ranked processes                                                             | top -n 1 -b                                                           |                                               | 
|                                                                                                           | process data : display a tree of processes                                                          | pstree -a                                                             |                                               | 
| 	process data : report memory map of a process	pmap -d  `ps -A -o pid | grep -v PID |  tr "\n" " "  `     |                                                                                                     |                                                                       |                                               | 
|                                                                                                           | process data : snapshot of the all processes with wide output                                       | ps -eafww                                                             |                                               | 
|                                                                                                           | process data : snapshot of the all processes with wide output                                       | ps auxww                                                              |                                               | 
|                                                                                                           | process of file search : configuration file                                                         | whereis -b FILE                                                       | need to find all config for Akraino Stack     | 
|                                                                                                           | process of file search : executable file                                                            | which -a FILE                                                         | need to find all executable for Akraino Stack | 
|                                                                                                           | process of user                                                                                     | ps -u                                                                 |                                               | 
|                                                                                                           | process of user : look up or signal processes based on name and other attributes                    | pgrep -U `users`                                                      |                                               | 
|                                                                                                           | service config                                                                                      | ls /etc/rc*.d                                                         |                                               | 
|                                                                                                           | show status of modules                                                                              | lsmod                                                                 |                                               | 
|                                                                                                           | show status of modules                                                                              | cat /proc/modules                                                     |                                               | 
|                                                                                                           | iptable config                                                                                      | iptables-t nat -nL                                                    |                                               | 
|                                                                                                           | iptable config                                                                                      | iptables -t mangle -nL                                                |                                               | 
|                                                                                                           | iptable config                                                                                      | iptables -t filter -nL                                                |                                               | 
|                                                                                                           | iptable config                                                                                      | iptables -t raw -nL                                                   |                                               | 
| linux artifact investigation	find accounts with null password	awk -F: '($2 == "") {print $1}' /etc/shadow |                                                                                                     |                                                                       |                                               | 
|                                                                                                           | sort password by UID to confirm account creation order                                              | sort -nk3 -t: /etc/passwd                                             |                                               | 
|                                                                                                           | find duplicate user ID                                                                              | cut -f3 -d: /etc/passwd | sort -n | uniq -c | awk '!/ 1 / {print $2}' |                                               | 
|                                                                                                           | find supersuer and root acounts                                                                     | awk -F: '($3 == 0) {print $1}' /etc/passwd egrep ':0+:' /etc/passwd   |                                               | 
|                                                                                                           | orphan files                                                                                        | find / -nouser -print                                                 |                                               | 
|                                                                                                           | command history files                                                                               | cat ~/.bash_history                                                   |                                               | 
|                                                                                                           | file system information                                                                             | cat /proc/mounts                                                      |                                               | 
|                                                                                                           | file system information                                                                             | cat /etc/fstab                                                        |                                               | 
|                                                                                                           | scheduled jobs: queue, examine or delete jobs for later execution                                   | at                                                                    |                                               | 
|                                                                                                           | scheduled jobs: daily                                                                               | ls -al /etc/cron.daily/                                               |                                               | 
|                                                                                                           | scheduled jobs: weekly                                                                              | ls -al /etc/cron.weekly/                                              |                                               | 
|                                                                                                           | scheduled jobs: configuration                                                                       | cat /etc/crontab                                                      |                                               | 
|                                                                                                           | user permission for cron                                                                            | cat /etc/cron.allow                                                   |                                               | 
|                                                                                                           | user permission for cron                                                                            | cat /etc/cron.deny                                                    |                                               | 
|                                                                                                           | host permission                                                                                     | cat /etc/hosts.allow                                                  |                                               | 
|                                                                                                           | host permission                                                                                     | cat /etc/hosts.deny                                                   |                                               | 
|                                                                                                           | check off system logging                                                                            | cat /etc/rsyslog.conf                                                 |                                               | 
|                                                                                                           | check off system logging                                                                            | ls -al /etc/rsyslog.d/                                                |                                               | 
|                                                                                                           | last logon data : short list                                                                        | last                                                                  |                                               | 
|                                                                                                           | last logon data : full list                                                                         | lastlog                                                               |                                               | 
|                                                                                                           | copy all logs out                                                                                   | cp -R /var/log/* /media/logs                                          |                                               | 
|                                                                                                           | verify integrity of installed software                                                              | dpkg -l                                                               |                                               | 
